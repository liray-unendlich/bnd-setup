# スクリプトファイル説明

## インフラセットアップ用（root権限必要）

### `setup-node1-root.sh`
- **用途**: ノード1（メインノード）の完全セットアップ
- **実行者**: rootユーザー
- **機能**:
  - システムアップデート
  - Docker & Docker Composeインストール
  - 作業用ユーザー作成
  - 基本ファイアウォール設定
  - システム最適化設定

### `setup-node2-root.sh`
- **用途**: ノード2（GPUノード）の完全セットアップ
- **実行者**: rootユーザー
- **機能**:
  - システムアップデート
  - NVIDIAドライバーインストール
  - Docker & NVIDIA Container Toolkitインストール
  - 作業用ユーザー作成
  - GPU最適化設定

## 開発環境セットアップ用（一般ユーザー）

### `setup-dev-environment.sh`
- **用途**: Boundless開発環境の構築
- **実行者**: 一般ユーザー（非root）
- **機能**:
  - Rustインストール
  - RISC Zero toolchainインストール
  - Foundryインストール
  - Node.js & bunインストール（オプション）
  - Boundlessプロジェクトクローン（オプション）
  - 環境確認スクリプト生成

### `build-boundless.sh`
- **用途**: Boundlessプロジェクトの自動ビルド
- **実行者**: 一般ユーザー
- **機能**:
  - 環境確認
  - Solidityコントラクトビルド（forge build）
  - Rustクレートビルド（cargo build）
  - テスト実行（オプション）
  - ドキュメント生成（オプション）

## デプロイメント用

### `deploy-node1.sh`
- **用途**: ノード1のサービスデプロイ
- **実行者**: 一般ユーザー
- **機能**:
  - 段階的サービス起動
  - ヘルスチェック
  - 起動確認

### `deploy-node2.sh`
- **用途**: ノード2のGPUサービスデプロイ
- **実行者**: 一般ユーザー
- **機能**:
  - ノード1接続確認
  - GPU動作確認
  - GPUエージェント起動
  - マルチGPU対応

### `quick-deploy.sh`
- **用途**: 設定済み環境での一括デプロイ
- **実行者**: 一般ユーザー
- **機能**:
  - ノード1自動デプロイ
  - ヘルスチェック
  - ノード2デプロイ指示

## ネットワーク設定用

### `setup-firewall-node1.sh`
- **用途**: ノード1のファイアウォール詳細設定
- **実行者**: 一般ユーザー（sudo権限使用）
- **引数**: ノード2のIPアドレス
- **機能**:
  - 外部アクセスポート開放
  - ノード2からの内部ポートアクセス許可

### `setup-firewall-node2.sh`
- **用途**: ノード2のファイアウォール設定
- **実行者**: 一般ユーザー（sudo権限使用）
- **機能**:
  - 基本セキュリティ設定
  - GPU監視ポート設定（オプション）

## 実行順序

1. **初期セットアップ（各ノードで1回のみ）**:
   ```bash
   # rootユーザーで
   ./setup-node1-root.sh  # ノード1で
   ./setup-node2-root.sh  # ノード2で
   # システム再起動
   ```

2. **開発環境セットアップ（作業用ユーザーで）**:
   ```bash
   ./setup-dev-environment.sh
   ./build-boundless.sh  # Boundlessプロジェクトがある場合
   ```

3. **ファイアウォール設定**:
   ```bash
   ./setup-firewall-node1.sh <ノード2IP>  # ノード1で
   ./setup-firewall-node2.sh              # ノード2で
   ```

4. **デプロイメント**:
   ```bash
   ./deploy-node1.sh   # ノード1で
   ./deploy-node2.sh   # ノード2で
   ```

## トラブルシューティング

- **権限エラー**: スクリプトに実行権限があることを確認: `chmod +x *.sh`
- **パッケージエラー**: システムアップデートを先に実行: `sudo apt update && sudo apt upgrade`
- **ネットワークエラー**: ファイアウォール設定を確認
- **GPU認識エラー**: システム再起動後にGPU確認を実行